## 数码管

​		数码管一般分为**共阳极数码管**和**共阴极数码管**

- 共阳极数码管是指将所有发光二极管的阳极接到一起形成**共阳极**的数码管, 当某一字段发光二极管的**阴极为低电平时, 相应字段就点亮**, 当某一字段**阴极为高电平时, 相应字段就不亮**

- 共阴极数码管是指将所有发光二极管的阴极接到一起形成**共阴极**的数码管, 当某一字段发光二极管的**阳极为高电平时, 相应字段就点亮,** 当某一字段**阳极为低电平时, 相应字段就不亮**



共阴极数码管码表:

| 0 -> 0x3f | 1 -> 0x06 | 2 -> 0x5b | 3 -> 0x4f | 4 -> 0x66      | 5 -> 0x6d |
| --------- | --------- | --------- | --------- | -------------- | --------- |
| 6 -> 0x7d | 7 -> 0x07 | 8 -> 0x7f | 9 -> 0x6f | A -> 0x77      | B -> 0x7c |
| C -> 0x39 | D -> 0x5e | E -> 0x79 | F -> 0x71 | 无显示 -> 0x00 |           |

共阳极数码管码表:

| 0 -> 0xc0 | 1 -> 0xf9 | 2 -> 0xa4 | 3 -> 0xb0 | 4 -> 0x99      | 5 -> 0x92 |
| --------- | --------- | --------- | --------- | -------------- | --------- |
| 6 -> 0x82 | 7 -> 0xf8 | 8 -> 0x80 | 9 -> 0x90 | A -> 0x88      | B -> 0x83 |
| C -> 0xc6 | D -> 0xa1 | E -> 0x86 | F -> 0x8e | 无显示 -> 0xff |           |



​		因为单片机 IO 口外部都增加了外部上拉电阻，因此 **P22、P23、P24 引脚默认就是高电平**，**根据 38 译码器输出特点，此时 Y7 脚（LED8）输出有效，即低电平**。而数码管的段选 a-dp 连接在 74HC245 驱动芯片输出口，由 P0 端口控制。所以**只要控制 P0 口输出高电平，SMG1 最左边那个数码管默认就可以显示。**

<img src="E:\markdown\51单片机\pics\QQ截图20211105111934.png" alt="QQ截图20211105111934" style="zoom: 67%;" />

<img src="E:\markdown\51单片机\pics\QQ截图20211105111950.png" alt="QQ截图20211105111950" style="zoom: 67%;" />

### 74HC245芯片

​		74HC245 是一种三态输出、八路信号收发器，主要应用于大屏显示，以及其它的消费类电子产品中增加驱动。

![QQ截图20211105151854](E:\markdown\51单片机\pics\QQ截图20211105151854.png)

**管脚定义说明:**

|      符号       |   管脚名称    | 管脚号  |              说明               |
| :-------------: | :-----------: | :-----: | :-----------------------------: |
|     A0 - A7     | 数据输入/输出 |  2 - 9  |                                 |
|     B0 - B7     | 数据输入/输出 | 18 - 11 |                                 |
| $\overline{OE}$ |   输出使能    |   19    |                                 |
|       DIR       |   方向控制    |    1    | DIR=1, A -> B;    DIR=0, B -> A |
|       GND       |    逻辑地     |   20    |             逻辑地              |
|       VDD       |   逻辑电源    |   10    |             电源端              |

**功能真值表:**

<table style="text-align:center">
  <tr>
    <th>输出使能</th>
    <th>输出使能</th>
    <th rowspan='2'>工作状态</th>
  </tr>
  <tr>
  	<th>OE</th>
      <th>DIR</th>
  </tr>
  <tr>
    <td>L</td>
    <td>L</td>
      <td>Bn 输入 An 输出</td>
  </tr>
      <tr>
    <td>L</td>
    <td>H</td>
      <td>An 输入 Bn 输出</td>
  </tr>
      <tr>
    <td>H</td>
    <td>X</td>
      <td>高阻态</td>
  </tr>
</table>



### **74HC138** 芯片

​		74HC138D 是一种三通道输入、八通道输出译码器，主要应用于消费类电子产品。

<img src="E:\markdown\51单片机\pics\QQ截图20211105153848.png" alt="QQ截图20211105153848" style="zoom: 67%;" />

​		A0、A1、A2 输入就相当于 3 位 2 进制数，A0 是低位，A1 是次高位，A2 是高位。而 Y0-Y7 具体哪一个输出有效电平，就看输入二进制对应的十进制数值。比如输入是 101（A2，A1，A0），其对应的十进制数是 5，所以 Y5 输出有效电平（低电平）.



### 静态数码管实验

#### 代码

```c
#include "reg52.h"
#define SMG_A_DP_PORT P0

typedef unsigned int u16;
typedef unsigned char u8;

//共阴极数码管显示 0~F 的段码数据
u8 gsmg_code[17] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07,
                    0x7f, 0x6f, 0x77, 0x7c, 0x39, 0x5e, 0x79, 0x71};

void main() {
    SMG_A_DP_PORT = gsmg_code[0];
    while (1) {
    }
}
```

#### 实验现象

![QQ截图20211105113407](E:\markdown\51单片机\pics\QQ截图20211105113407.png)



---



### 动态数码管实验

​		动态数码管显示原理就是利用减少段选线，分开位选线，利用位选线不同时选择通断，改变段选数据来实现的。

​		比如在第一次选中第一位数码管时，给段选数据 0，下一次位选中第二位数码管时显示 1。为了在显示 1 的时候，0 不会消失（当然实际上是消失了），必须在人肉眼观察不到的时间里再次点亮第一次点亮的 0。而这时就需要记住，人**的肉眼正常情况下只能分辨变化超过 24ms 间隔的运动。**也就是说，在下一次点亮 0 这个数字的时间差不得大于 24ms。这时就会发现，数码管点亮是在向右或者向左一位一位点亮，形成了动态效果。如果把间隔时间改长就能直接展现这一现象。 

#### 代码

```c
#include "reg52.h"
#define SMG_A_DP_PORT P0

typedef unsigned int u16;
typedef unsigned char u8;

//共阴极数码管显示 0~F 的段码数据
u8 gsmg_code[17] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07,
                    0x7f, 0x6f, 0x77, 0x7c, 0x39, 0x5e, 0x79, 0x71};

void delay_10us(u16 ten_us) {
    while (ten_us--) {
    }
}

sbit LSA = P2 ^ 2;
sbit LSB = P2 ^ 3;
sbit LSC = P2 ^ 4;

void smg_display() {
    u8 i = 0;
    for (i = 0; i < 8; i++) {
        switch (i) {
            case 0:
                LSC = 1;
                LSB = 1;
                LSA = 1;
                break;
            case 1:
                LSC = 1;
                LSB = 1;
                LSA = 0;
                break;
            case 2:
                LSC = 1;
                LSB = 0;
                LSA = 1;
                break;
            case 3:
                LSC = 1;
                LSB = 0;
                LSA = 0;
                break;
            case 4:
                LSC = 0;
                LSB = 1;
                LSA = 1;
                break;
            case 5:
                LSC = 0;
                LSB = 1;
                LSA = 0;
                break;
            case 6:
                LSC = 0;
                LSB = 0;
                LSA = 1;
                break;
            case 7:
                LSC = 0;
                LSB = 0;
                LSA = 0;
                break;
        }
        SMG_A_DP_PORT = gsmg_code[i];  //传送段选数据
        delay_10us(100);  // delay_10us(100);//延时一段时间，等待显示稳定
        SMG_A_DP_PORT = 0x00;  // SMG_A_DP_PORT=0x00;//消音
    }
}

void main() {
    while (1) {
        smg_display();
    }
}
```



#### 实验现象

![QQ截图20211105154908](E:\markdown\51单片机\pics\QQ截图20211105154908.png)

